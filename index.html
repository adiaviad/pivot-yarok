
<!DOCTYPE html>
<html>
    <meta charset="UTF-8">
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script type="text/javascript" src="codeDataLoad.js"></script>
<script type="text/javascript" src="codeGraphicsGen.js"></script>
<style>
    .madad{
        width: 100%;
        border: 1px solid;
        border-collapse: collapse;
        justify-content: center;
        align-items: center;
        margin-left: auto;
        margin-right: auto;
        
    }
    mamad_tables_holder tr{
        margin-bottom: 100px;
    }
    table.madad td{
        text-align: center;
        border: 1px solid;
    }
    table.madad tr{
        border: 1px solid;
        
    }
    table.madad th{
        border: 1px solid;
        background-color: rgb(6, 53, 128);
    }
    trh{
        margin: 0%;
        padding: 0%;
        text-align: left;
    }
</style>

<body>
<h2>WIP</h2>
<table id="hon res table">
    <tr>
        <td>
            <div id="hon res graph" style="width:100%;max-width:700px"></div>
        </td>
        <td>
            <div id="hon res benchmark diff" style="width:100%;max-width:700px"></div>
        </td>
    </tr>
</table>
<div id="madad_al_table_container"></div>
<select id="hon res select"></select>


</body>
</html>
<script>
    var selected_region=0;
    const dropdown = document.getElementById("hon res select");

    // Populate the dropdown with options from the array
    function populateDropdownSelect(stringArray){
        stringArray.forEach((string, index) => {
            const option = document.createElement("option");
            option.text = string;
            option.value = index;
            dropdown.add(option);
        });
    }
   
    function select_region(){
        const inputElement = document.getElementById("myInput");
        selected_region = inputElement.value;
        generateGraph();

    }
    let resJson;
    let superMeasureData;
    // Call the function to generate the graph
    getResourceData('hon_planning_and_dev.xlsx')
        .then(jd=>{
            console.log("promise from code.js",jd);
            console.log("promise from code.js, profile",jd.res_profline);
            resJson=jd.res_profline;
            superMeasureData=jd.super_measurements;
            generateGraph(resJson);
            populateDropdownSelect(resJson.provinces_names);
            generateSuperMeasureTables(superMeasureData);

    });
    
    dropdown.addEventListener("change", function() {
        const selectedIndex = this.value;
        console.log("Selected Index:", selectedIndex);
        selected_region=selectedIndex;
        generateGraph(resJson);
        generateSuperMeasureTables(superMeasureData);

    });
</script>
